<h1>Patient Dashboard</h1>

<h2>Available Doctors</h2>
<% if @doctors.present? %>
  <% @doctors.each do |doctor| %>
    <div class="doctor-card">
      <p><%= doctor.name %> - <%= doctor.category.name %>
                            - Open slots: <%= 10 - doctor
                            .appointments.where(closed: false)
                            .count %></p>
      <% if 10 - doctor.appointments.where(closed: false).count > 0 %>
        <%= button_to "Book",
                        appointments_path(appointment: { doctor_id: doctor.id,
                        date: Time.zone.now }),
                        method: :post %>
      <% else %>
        <p class="no-slots">No free slots</p>
      <% end %>
    </div>
  <% end %>
<% else %>
  <p>No doctors available.</p>
<% end %>

<h2>My Open Appointments</h2>
<%= render partial: "shared/doctor_list",
           locals: { appointments: @open_appointments,
                     status: "Open" } %>

<h2>My Closed Appointments</h2>
<%= render partial: "shared/doctor_list",
           locals: { appointments: @closed_appointments,
                     status: "Closed" } %>

<h2>My Archived Appointments</h2>
<%= render partial: "shared/doctor_list",
           locals: { appointments: @archived_appointments,
                     status: "Archived" } %>


<%= button_to "Logout", destroy_user_session_path,
                        method: :delete,
                        class: "btn btn-logout" %>